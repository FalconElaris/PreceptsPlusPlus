<?xml version="1.0" encoding="utf-8" ?>
<Defs>

	<RulePackDef>
		<defName>NamerRitualRevealTheTraditions</defName>
		<rulePack>
			  <rulesStrings>
			  
					<li>r_ritualName->[ritNoun] of [keyDeity]</li>
					<li>r_ritualName->[ritNoun] of [chosenTheme]</li>
					<li>r_ritualName->[ritNoun] of [memeConcept]</li>
					<li>r_ritualName->[memeAdjective] [ritNoun]</li>

					<li>ritNoun->lore</li>
					<li>ritNoun->tradition</li>
					<li>ritNoun->prophesies</li>
				
			  </rulesStrings>
		</rulePack>
	</RulePackDef>
	
	
	<PreceptDef>
		<defName>OralTradition</defName>
		<label>oral tradition</label>
		<description>A means to communicate our culture from generation to generation in the hearts and minds of our people through speech and memorization.</description>
		<issue>Ritual</issue>
		<impact>Medium</impact>
		<iconPath>UI/Precepts/OralTraditionSymbol</iconPath>
		<preceptClass>Precept_Ritual</preceptClass>
		<ritualPatternBase>OralTradition</ritualPatternBase>
		<allowDuplicates>false</allowDuplicates>
		<countsTowardsPreceptLimit>true</countsTowardsPreceptLimit>
		<selectionWeight>1.0</selectionWeight>
		<displayOrderInImpact>100</displayOrderInImpact>
		<ignoreLimitsInEditMode>false</ignoreLimitsInEditMode>
		<receivesExpectationsQualityOffset>false</receivesExpectationsQualityOffset>
		<canGenerateAsSpecialPrecept>false</canGenerateAsSpecialPrecept>
		<associatedMemes>
		  <li>OralTradition</li>
		</associatedMemes>
		<requiredMemes>
		  <li>OralTradition</li>
		</requiredMemes>
		<modExtensions>
			<li Class="TPRitualAttachableOutcomes.Precept_Ritual_Custom">
				<coolDownDays>7</coolDownDays>
			</li>
		</modExtensions>
	</PreceptDef>
	
	
	<RitualPatternDef>
		<defName>OralTradition</defName>
		<ritualBehavior>OralTradition</ritualBehavior>
		<ritualTargetFilter>AltarOrRitualSpot</ritualTargetFilter>
		<ritualObligationTargetFilter>RitualSpotOrAltar</ritualObligationTargetFilter>
		<ritualExplanation>In case of success, all attendees will be inspired to learn with greater zeal. If it backfires, their interest in greater understanding will decrease.</ritualExplanation>
		<ritualOutcomeEffect>OralTradition</ritualOutcomeEffect>
		<nameMaker>NamerRitualRevealTheTraditions</nameMaker>
		<shortDescOverride>Oral Tradition</shortDescOverride>
		<descOverride>Pass on the Traditions</descOverride>
		<ritualOnlyForIdeoMembers>true</ritualOnlyForIdeoMembers>
		<canStartAnytime>true</canStartAnytime>
		<tags>
			<li>OralTradition</li>
		</tags>
		<patternGroupTag>OralTradition</patternGroupTag>
	</RitualPatternDef>
	
	<RitualBehaviorDef>
    <defName>OralTradition</defName>
    <workerClass>RitualBehaviorWorker_Speech</workerClass>
    <durationTicks>5000</durationTicks>
    <letterTitle>{RITUAL_labelCap}</letterTitle>
    <letterText>{SPEAKER_labelShort} is giving a {RITUAL_labelIndef}.
      \nIf all goes well, listeners will feel inspired, and gain a bonus to their research abilities. If it goes poorly, the speech will reduce their ability to research.</letterText>
    <roles>
      <li Class="RitualRoleTag">
        <label>speaker</label>
        <tag>Moralist</tag>
        <id>speaker</id>
        <precept>IdeoRole_Moralist</precept>
        <required>True</required>
        <substitutable>False</substitutable>
		<maxCount>1</maxCount>
        <countsAsParticipant>False</countsAsParticipant>
      </li>
    </roles>
    <stages>
      <li>
        <defaultDuty>Spectate</defaultDuty>
        <allowedSpectateSidesOverride>Vertical</allowedSpectateSidesOverride>
        <spectateDistanceOverride>1</spectateDistanceOverride>
        <spectatorsRequired>true</spectatorsRequired>
        <endTriggers>
          <li Class="StageEndTrigger_DurationPercentage">
            <percentage>1</percentage>
          </li>
        </endTriggers>
        <roleBehaviors>
          <li>
            <roleId>speaker</roleId>
            <dutyDef>SpeakOnCell_Leader</dutyDef>
            <speakerInteraction>Speech_Leader</speakerInteraction>
            <customPositions>
              <li Class="RitualPosition_OnInteractionCell" />
            </customPositions>
          </li>
        </roleBehaviors>
        <visualEffectDef>Speech</visualEffectDef>
      </li>
    </stages>
  </RitualBehaviorDef>
  
  <RitualOutcomeEffectDef>
    <defName>OralTradition</defName>
    <description>Depending on ritual quality, participants will get between -6 and +6 mood for {MOODDAYS} days.</description>

	<workerClass>TPRitualAttachableOutcomes.RitualOutcomeEffectWorker_FromQuality_TP_Custom</workerClass>
    <allowAttachableOutcome>false</allowAttachableOutcome>
    <comps>
	  <li Class="RitualOutcomeComp_PawnStatScaled">
        <label>{PAWN_labelShort}'s social impact</label>
        <labelAbstract>speaker's social impact</labelAbstract>
        <roleId>moralist</roleId>
        <statDef>SocialImpact</statDef>
        <curve>
          <points>
            <li>(0.2,  0.0)</li>
            <li>(0.6,  0.18)</li>
            <li>(1.0, 0.25)</li>
            <li>(1.5, 0.3)</li>
          </points>
        </curve>
      </li>
      <li Class="RitualOutcomeComp_ParticipantCount">
        <label>participant count</label>
        <curve>
          <points>
            <li>(1,  0.0)</li>
            <li>(5,  0.3)</li>
            <li>(10, 0.4)</li>
          </points>
        </curve>
      </li>
	  <li Class="RitualOutcomeComp_RitualSeatPresent">
        <qualityOffset>0.15</qualityOffset>
      </li>
    </comps>
    <outcomeChances>
      <li>
        <label>Terrible</label>
		<chance>0.15</chance>
		<memory>TerribleRevelation</memory>
        <description>The {0} was terrible! Our traditions are meaningless!</description>
		<positivityIndex>-2</positivityIndex>
      </li>
      <li>
        <label>Bad</label>
        <chance>0.35</chance>
        <memory>BadSpokenTradition</memory>
        <description>The {0} was bad. The prophesies surely are irrelevant to us.</description>
        <positivityIndex>-1</positivityIndex>
      </li>
      <li>
        <label>Satisfying</label>
        <chance>0.35</chance>
        <memory>SatisfyingExpositionofLore</memory>
        <description>The {0} was satisfying. We're surely on the right path.</description>
        <positivityIndex>1</positivityIndex>
      </li>
      <li>
        <label>Spectacular</label>
        <chance>0.15</chance>
        <memory>SpectacularRevelationOfProphesy</memory>
        <description>The {0} was spectacular! We are truely walking in the footsteps of our ancestors. They smile upon us!</description>
        <positivityIndex>2</positivityIndex>
      </li>
    </outcomeChances>

	<modExtensions>
		<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom">
			<node Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom_Node">
				<li>
					<triggerPositivityIndex>
						<li>-2</li>
						<li>-1</li>
					</triggerPositivityIndex>
					<hediffToAdd>
						<li>ResearchSpeedDown</li>
					</hediffToAdd>
				</li>
				<li>
					<triggerPositivityIndex>						
						<li>1</li>
						<li>2</li>
					</triggerPositivityIndex>
					<hediffToAdd>
						<li>ResearchSpeedUp</li>
					</hediffToAdd>
				</li>
			</node>
		</li>
	</modExtensions>
  </RitualOutcomeEffectDef>
	
  <ThoughtDef>
    <defName>TerribleRevelation</defName>
    <thoughtClass>Thought_AttendedRitual</thoughtClass>
    <durationDays>6</durationDays>
    <stackLimit>3</stackLimit>
    <stages>
      <li>
        <label>terrible ritual</label>
        <description>Our ways are all but lost!</description>
        <baseMoodEffect>-6</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>

  <ThoughtDef>
    <defName>BadSpokenTradition</defName>
    <thoughtClass>Thought_AttendedRitual</thoughtClass>
    <durationDays>6</durationDays>
    <stackLimit>3</stackLimit>
    <stages>
      <li>
        <label>bad ritual</label>
        <description>Our traditions are murky and uncertain.</description>
        <baseMoodEffect>-2</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>

  <ThoughtDef>
    <defName>SatisfyingExpositionofLore</defName>
    <thoughtClass>Thought_AttendedRitual</thoughtClass>
    <durationDays>6</durationDays>
    <stackLimit>3</stackLimit>
    <stages>
      <li>
        <label>satisfying ritual</label>
        <description>We are following the right way of living.</description>
        <baseMoodEffect>2</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>

  <ThoughtDef>
    <defName>SpectacularRevelationOfProphesy</defName>
    <thoughtClass>Thought_AttendedRitual</thoughtClass>
    <durationDays>6</durationDays>
    <stackLimit>3</stackLimit>
    <stages>
      <li>
        <label>inspiring ritual</label>
        <description>Our ancestors smile upon us for following their ways so well!</description>
        <baseMoodEffect>6</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>
	
  <HediffDef>
    <defName>ResearchSpeedUp</defName>
    <label>Cultural Inspiration</label>
    <description>Inspired to do research.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <comps>
      <li Class="HediffCompProperties_Disappears">
	     <disappearsAfterTicks>450000</disappearsAfterTicks>
        <showRemainingTime>True</showRemainingTime>
      </li>
      <li Class="HediffCompProperties_DisappearsOnDeath"/>
    </comps>
    <isBad>false</isBad>
    <stages>
	  <li>
        <statOffsets>
		  <ResearchSpeed>0.1</ResearchSpeed>
          <GlobalLearningFactor>0.05</GlobalLearningFactor>
		</statOffsets>
	  </li>
    </stages>
	<defaultLabelColor>(0.3, 1, 0.3)</defaultLabelColor>
  </HediffDef>
  
  <HediffDef>
    <defName>ResearchSpeedDown</defName>
    <label>Cultural Malaise</label>
    <description>Uninspired to do research.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <comps>
      <li Class="HediffCompProperties_Disappears">
	     <disappearsAfterTicks>450000</disappearsAfterTicks>
        <showRemainingTime>True</showRemainingTime>
      </li>
      <li Class="HediffCompProperties_DisappearsOnDeath"/>
    </comps>
    <isBad>true</isBad>
    <stages>
      <li>
        <statOffsets>
		  <ResearchSpeed>-0.1</ResearchSpeed>
          <GlobalLearningFactor>-0.05</GlobalLearningFactor>
		</statOffsets>
	  </li>
    </stages>
	<defaultLabelColor>(0.3, 1, 0.3)</defaultLabelColor>
  </HediffDef>
	

</Defs>